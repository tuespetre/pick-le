<!DOCTYPE html>
<html>

<head>
    <title>pickle-select demo</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <script src="./bower_components/shadow-dom/dist/shadow-dom.js"></script>
    <script>
        (function () {
            'use strict';

            var pickle = './dist/pick-le.js';

            if (!es2015SyntaxSupported()) {
                pickle = './dist/pick-le.es5.js'
            }

            addScript(pickle);

            function addScript(src, onload) {
                var script = document.createElement('script');
                script.src = src;
                script.async = false;
                if (onload) {
                    script.onload = onload;
                }
                document.head.appendChild(script);
            }

            function es2015SyntaxSupported() {
                try {
                    return new Function('for(const{_}of[((..._)=>class{constructor(){new.target}})(...[``])]){let $={_}}');
                }
                catch (error) {
                    return false;
                }
            }
        })();
    </script>
    <style>
        pickle-select:not([defined]) :not([slot=toggle]) {
            display: none;
        }
    </style>
</head>

<body>
    <header class="navbar navbar-default navbar-static-top">
        <div class="container">
        </div>
    </header>
    <div class="container">
        <h3>Things to think about</h3>
        <ul>
            <li>
                <del>What about aggregating a 'change' event?</del>
            </li>
            <li>
                <del>What happens when adding a new [selected] pickle-option to a pickle-select?</del>
            </li>
            <li>
                What about replacing the whole list of options in the pickle-select?
            </li>
            <li>
                What about a 'filter' event that can be canceled, providing a chance to fetch remotely filtered data and re-populate the
                options?
            </li>
            <li>
                Best way to disable the filtering (including hiding the tool?)
            </li>
            <li>
                Best way to left/right/top/bottom align the popup?
            </li>
        </ul>
        <hr />
        <h3>Avoiding flash of unstyled content</h3>
        <p>
            The following &lt;style&gt; snippet can be used to ensure that only the
            toggle button is shown until the custom element is defined:
        </p>
        <pre id="fouc-snippet"></pre>
        <script>
            document.getElementById('fouc-snippet').textContent = `                
<style>
    pickle-select:not([defined]) :not([slot=toggle]) {
        display: none;
    }
</style>
            `.trim();
        </script>
        <hr />
    </div>
    <form class="container">
        <h3>Simple usage examples</h3>
        <hr />
        <p id="link-example-container"></p>
        <pre id="link-example-snippet"></pre>
        <script>
            const linkExample = `
<pickle-select name="links" type="navigation" data-title="Title for the pickle-select">
    <button slot="toggle" class="btn btn-default">
        Links by setting [type=navigation]
    </button>
    <pickle-option value="#" selected>
        Link one
    </pickle-option>
    <pickle-option value="#">
        Link two
    </pickle-option>
    <pickle-option value="#">
        Link three
    </pickle-option>
    <pickle-option value="#">
        <h4>Mark up and style option contents as you wish!</h4>
        <p style="color: red; text-decoration: underline;">It's flexible!</p>
    </pickle-option>
</pickle-select>
            `;
            document.getElementById('link-example-container').innerHTML = linkExample;
            document.getElementById('link-example-snippet').textContent = linkExample.trim();
        </script>
        <hr />
        <pickle-select name="radios" type="radio" data-title="Title for the pickle-select">
            <button slot="toggle" class="btn btn-default">
                Single-select by setting [type=radio]
            </button>
            <div slot="tool">
                This is where you can put an extra tool, maybe like a button or something!
            </div>
        </pickle-select>
        <hr />
        <pickle-select name="checkboxes" type="checkbox" data-title="Title for the pickle-select">
            <button slot="toggle" class="btn btn-default">
                Multi-select by setting [type=checkbox]
            </button>
            <div slot="tool">
                This is where you can put an extra tool, maybe like a button or something!
            </div>
        </pickle-select>
        <hr />
        <button type="submit" class="btn btn-primary">
            See the outputs in the query string
        </button>
    </form>
    <script>
        var radios = document.querySelector('[name=radios]');
        for (var i = 0; i < 20; i++) {
            var num = i + 1;
            var option = document.createElement('pickle-option');
            option.value = num;
            option.textContent = 'Option ' + num;
            radios.appendChild(option);
        }
        setTimeout(function () {
            radios.querySelector('pickle-option').selected = true;
            var newOption = document.createElement('pickle-option');
            newOption.value = 21;
            newOption.textContent = 'Inserted after the fact -- what happens?';
            newOption.selected = true;
            radios.appendChild(newOption);
        });

        var checkboxes = document.querySelector('[name=checkboxes]');
        for (var i = 0; i < 20; i++) {
            var num = i + 1;
            var option = document.createElement('pickle-option');
            option.value = num;
            option.textContent = 'Option ' + num;
            checkboxes.appendChild(option);
        }
        
        checkboxes.addEventListener('change', function (event) {
            var optionsNodeList = checkboxes.querySelectorAll('pickle-option');
            var options = Array.prototype.slice.call(optionsNodeList);

            var text = options
                .filter(function (option) { return option.selected; })
                .map(function (option) { return option.text; })
                .join(', ');

            console.log(text || 'Select');
        });
    </script>
</body>

</html>